import{ap as v,X as x,Y as y,Z as b,x as k,A as w,a0 as B,a2 as C,a3 as t,ab as q,c as s,ad as r,aa as i,V as S,J as A,a7 as F,a8 as N,ae as P}from"./index-c5d70e80.js";import{c as R,f as $,u as M,d as D,V as E}from"./index.esm-54084326.js";import{V as I}from"./VContainer-f5d12765.js";import{V as J,a as c}from"./VRow-36effc04.js";const j={__name:"MailmanView",setup(L){const f=v(),m=x(),{api:T,apiAuth:d}=q(),n=y(),p=b(),e=k({_id:"",code:"",experience:"",skills:"",image:"",pass:!0}),_=R({quantity:$().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:V,handleSubmit:g}=M({validationSchema:_,initialValues:{quantity:1}});return D("quantity"),g(async u=>{var l,a;if(!p.isLogin){m.push("/login");return}try{const{data:o}=await d.patch("/users/cart",{mailman:e.value._id,quantity:u.quantity});p.cart=o.result,n({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})}catch(o){const h=((a=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:a.message)||"發生錯誤，請稍後再試";n({text:h,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),w(async()=>{var u,l;try{const{data:a}=await d.get("/mailmans/"+f.params.id);e.value._id=a.result._id,e.value.code=a.result.code,e.value.experience=a.result.experience,e.value.skills=a.result.skills,e.value.image=a.result.image,e.value.pass=a.result.pass,document.title=`購物網 | ${e.value.name}`}catch(a){const o=((l=(u=a==null?void 0:a.response)==null?void 0:u.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";n({text:o,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}}),m.push("/")}}),(u,l)=>(B(),C(I,null,{default:t(()=>[s(P,null,{default:t(()=>[s(J,null,{default:t(()=>[s(c,{cols:"12"},{default:t(()=>[r("h1",null,"幹員 "+i(e.value.code),1)]),_:1}),s(c,{cols:"12",md:"6"},{default:t(()=>[s(S,{src:e.value.image,cover:""},null,8,["src"])]),_:1}),s(c,{cols:"12",md:"6"},{default:t(()=>[r("p",null,i(e.value.skills),1),r("p",null,i(e.value.experience),1),s(E,null,{default:t(()=>[s(A,{type:"submit","prepend-icon":"mdi-cart",loading:F(V)},{default:t(()=>[N("指定幹員")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{j as default};
