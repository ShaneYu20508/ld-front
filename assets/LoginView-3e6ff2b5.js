import{X as x,Y as _,Z as S,a0 as k,a2 as y,a3 as r,ab as B,c as t,ae as C,a7 as e,af as F,ag as i,J as M,a8 as U}from"./index-607a8a67.js";import{c as q,a as m,u as L,d,V as N}from"./index.esm-d16b0be2.js";import{V as P,a as R}from"./VRow-e4f68762.js";const J={__name:"LoginView",setup(T){const{api:p}=B(),g=x(),c=_(),b=S(),V=q({account:m().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:m().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:f,isSubmitting:w}=L({validationSchema:V}),l=d("account"),n=d("password"),h=f(async u=>{var a,s;try{const{data:o}=await p.post("/users/login",{account:u.account,password:u.password});b.login(o.result),c({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),g.push("/")}catch(o){console.log(o);const v=((s=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";c({text:v,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(u,a)=>(k(),y(P,{id:"login-home",class:"bg-c1 align-center justify-center h-100"},{default:r(()=>[t(R,{cols:"12"},{default:r(()=>[t(C,{id:"card",class:"pa-3 ma-auto",width:"450",title:"Login"},{default:r(()=>[t(N,{disabled:e(w),onSubmit:F(e(h),["prevent"])},{default:r(()=>[t(i,{label:"使用者名稱",minlength:"4",maxlength:"20",counter:"",modelValue:e(l).value.value,"onUpdate:modelValue":a[0]||(a[0]=s=>e(l).value.value=s),"error-messages":e(l).errorMessage.value},null,8,["modelValue","error-messages"]),t(i,{label:"密碼",minlength:"4",maxlength:"20",counter:"",type:"password",modelValue:e(n).value.value,"onUpdate:modelValue":a[1]||(a[1]=s=>e(n).value.value=s),"error-messages":e(n).errorMessage.value},null,8,["modelValue","error-messages"]),t(M,{type:"submit",color:"green"},{default:r(()=>[U("登入")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{J as default};
